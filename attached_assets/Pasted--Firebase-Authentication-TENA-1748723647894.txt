# ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

## ğŸ¯ å®Ÿè£…ç›®æ¨™
**Firebase Authentication ã‚’ä½¿ç”¨ã—ãŸæœ¬æ ¼çš„ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰**
æ—¢å­˜ã®TENAX/PERSISTOã‚¢ãƒ—ãƒªã«å®‰å…¨ã§ä½¿ã„ã‚„ã™ã„èªè¨¼æ©Ÿèƒ½ã‚’è¿½åŠ 

## ğŸ” èªè¨¼ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

### å¿…é ˆæ©Ÿèƒ½
```
âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼ˆãƒ¡ãƒ¼ãƒ« + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
âœ… ãƒ¡ãƒ¼ãƒ«èªè¨¼ï¼ˆç¢ºèªãƒªãƒ³ã‚¯é€ä¿¡ï¼‰
âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼ˆãƒ¡ãƒ¼ãƒ«çµŒç”±ï¼‰
âœ… èªè¨¼çŠ¶æ…‹ã®æ°¸ç¶šåŒ–
âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
âœ… æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ã®ç´ä»˜ã‘
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶
```
âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯
âœ… ãƒ¡ãƒ¼ãƒ«èªè¨¼å¿…é ˆ
âœ… ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹é˜²æ­¢
âœ… ã‚»ã‚­ãƒ¥ã‚¢ãªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
âœ… CSRFå¯¾ç­–
âœ… å…¥åŠ›å€¤æ¤œè¨¼
```

## ğŸ”¥ Firebase Authentication å®Ÿè£…

### Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
```javascript
// firebase-config.js
import { initializeApp } from 'firebase/app';
import { 
  getAuth, 
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  sendEmailVerification,
  sendPasswordResetEmail,
  updatePassword,
  onAuthStateChanged,
  signOut
} from 'firebase/auth';

const firebaseConfig = {
  apiKey: "your-api-key",
  authDomain: "tenax-app.firebaseapp.com", 
  projectId: "tenax-app",
  storageBucket: "tenax-app.appspot.com",
  messagingSenderId: "your-sender-id",
  appId: "your-app-id"
};

const app = initializeApp(firebaseConfig);
export const auth = getAuth(app);
```

### èªè¨¼é–¢æ•°ã®å®Ÿè£…
```javascript
// auth-functions.js

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
export const registerUser = async (email, password) => {
  try {
    const userCredential = await createUserWithEmailAndPassword(auth, email, password);
    await sendEmailVerification(userCredential.user);
    return { success: true, user: userCredential.user };
  } catch (error) {
    return { success: false, error: error.message };
  }
};

// ãƒ­ã‚°ã‚¤ãƒ³
export const loginUser = async (email, password) => {
  try {
    const userCredential = await signInWithEmailAndPassword(auth, email, password);
    if (!userCredential.user.emailVerified) {
      return { success: false, error: 'ãƒ¡ãƒ¼ãƒ«èªè¨¼ãŒå¿…è¦ã§ã™' };
    }
    return { success: true, user: userCredential.user };
  } catch (error) {
    return { success: false, error: error.message };
  }
};

// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
export const resetPassword = async (email) => {
  try {
    await sendPasswordResetEmail(auth, email);
    return { success: true };
  } catch (error) {
    return { success: false, error: error.message };
  }
};
```

## ğŸ“± èªè¨¼UIå®Ÿè£…

### 1. ç™»éŒ²ç”»é¢ï¼ˆRegisterï¼‰
```html
<!-- register.html -->
<div class="auth-container">
  <h2>{{ 'register.title' | translate }}</h2>
  <form id="registerForm">
    <div class="form-group">
      <label>{{ 'forms.email' | translate }}</label>
      <input type="email" id="email" required>
    </div>
    
    <div class="form-group">
      <label>{{ 'forms.password' | translate }}</label>
      <input type="password" id="password" required>
      <div class="password-requirements">
        â€¢ {{ 'register.password_length' | translate }}
        â€¢ {{ 'register.password_chars' | translate }}
      </div>
    </div>
    
    <div class="form-group">
      <label>{{ 'forms.confirm_password' | translate }}</label>
      <input type="password" id="confirmPassword" required>
    </div>
    
    <button type="submit" class="btn-primary">
      {{ 'buttons.register' | translate }}
    </button>
  </form>
  
  <div class="auth-links">
    <a href="/login">{{ 'auth.already_have_account' | translate }}</a>
  </div>
</div>
```

### 2. ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ï¼ˆLoginï¼‰
```html
<!-- login.html -->
<div class="auth-container">
  <h2>{{ 'login.title' | translate }}</h2>
  <form id="loginForm">
    <div class="form-group">
      <label>{{ 'forms.email' | translate }}</label>
      <input type="email" id="email" required>
    </div>
    
    <div class="form-group">
      <label>{{ 'forms.password' | translate }}</label>
      <input type="password" id="password" required>
    </div>
    
    <button type="submit" class="btn-primary">
      {{ 'buttons.login' | translate }}
    </button>
  </form>
  
  <div class="auth-links">
    <a href="/forgot-password">{{ 'auth.forgot_password' | translate }}</a>
    <a href="/register">{{ 'auth.create_account' | translate }}</a>
  </div>
</div>
```

### 3. ãƒ¡ãƒ¼ãƒ«èªè¨¼ç¢ºèªç”»é¢
```html
<!-- verify-email.html -->
<div class="verification-container">
  <div class="verification-icon">ğŸ“§</div>
  <h2>{{ 'verify.title' | translate }}</h2>
  <p>{{ 'verify.message' | translate }}</p>
  
  <div class="verification-actions">
    <button id="resendBtn" class="btn-secondary">
      {{ 'verify.resend' | translate }}
    </button>
    <button id="checkBtn" class="btn-primary">
      {{ 'verify.check_verification' | translate }}
    </button>
  </div>
</div>
```

## ğŸ”§ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆ

### Flask + Firebase Admin SDK
```python
# app.py
import firebase_admin
from firebase_admin import credentials, auth
from functools import wraps

# Firebase Admin åˆæœŸåŒ–
cred = credentials.Certificate('path/to/serviceAccountKey.json')
firebase_admin.initialize_app(cred)

# èªè¨¼ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿
def firebase_auth_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        token = request.headers.get('Authorization')
        if not token:
            return jsonify({'error': 'No token provided'}), 401
        
        try:
            decoded_token = auth.verify_id_token(token.replace('Bearer ', ''))
            request.current_user = decoded_token
            return f(*args, **kwargs)
        except Exception as e:
            return jsonify({'error': 'Invalid token'}), 401
    
    return decorated_function

# ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—API
@app.route('/api/user', methods=['GET'])
@firebase_auth_required
def get_user():
    uid = request.current_user['uid']
    email = request.current_user['email']
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
    user_data = get_user_data(uid)
    return jsonify(user_data)

# ãƒ‡ãƒ¼ã‚¿ä¿å­˜API
@app.route('/api/workouts', methods=['POST'])
@firebase_auth_required
def save_workout():
    uid = request.current_user['uid']
    workout_data = request.json
    workout_data['user_uid'] = uid
    
    # ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆãƒ‡ãƒ¼ã‚¿ä¿å­˜
    save_workout_data(workout_data)
    return jsonify({'success': True})
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ‹¡å¼µ
```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ‹¡å¼µ
ALTER TABLE users ADD COLUMN firebase_uid VARCHAR(255) UNIQUE;
ALTER TABLE users ADD COLUMN email VARCHAR(255) UNIQUE;
ALTER TABLE users ADD COLUMN email_verified BOOLEAN DEFAULT FALSE;
ALTER TABLE users ADD COLUMN created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;

-- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ã®ç´ä»˜ã‘
ALTER TABLE workouts ADD COLUMN user_uid VARCHAR(255);
ALTER TABLE body_measurements ADD COLUMN user_uid VARCHAR(255);
ALTER TABLE form_analyses ADD COLUMN user_uid VARCHAR(255);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
CREATE INDEX idx_users_firebase_uid ON users(firebase_uid);
CREATE INDEX idx_workouts_user_uid ON workouts(user_uid);
```

## ğŸ¨ èªè¨¼ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ•ãƒ­ãƒ¼
```
1. ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯
3. Firebase ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
4. ãƒ¡ãƒ¼ãƒ«èªè¨¼é€ä¿¡
5. ã€Œãƒ¡ãƒ¼ãƒ«ç¢ºèªã—ã¦ãã ã•ã„ã€ç”»é¢è¡¨ç¤º
6. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒ¼ãƒ«å†…ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯
7. èªè¨¼å®Œäº† â†’ ã‚¢ãƒ—ãƒªåˆ©ç”¨é–‹å§‹
```

### ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ãƒ­ãƒ¼
```
1. ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
2. Firebase èªè¨¼
3. ãƒ¡ãƒ¼ãƒ«èªè¨¼æ¸ˆã¿ãƒã‚§ãƒƒã‚¯
4. æˆåŠŸ â†’ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã¸
5. å¤±æ•— â†’ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
```

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ•ãƒ­ãƒ¼
```
1. ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸã€ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯
2. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›
3. Firebase ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ¡ãƒ¼ãƒ«é€ä¿¡
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒ¼ãƒ«å†…ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯
5. æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®š
6. ãƒ­ã‚°ã‚¤ãƒ³å¯èƒ½
```

## ğŸŒ å¤šè¨€èªå¯¾å¿œ

### èªè¨¼é–¢é€£ã®ç¿»è¨³
```json
{
  "auth": {
    "login": "ãƒ­ã‚°ã‚¤ãƒ³ / Login",
    "register": "æ–°è¦ç™»éŒ² / Sign Up", 
    "logout": "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ / Logout",
    "forgot_password": "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸ / Forgot Password",
    "reset_password": "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ / Reset Password",
    "verify_email": "ãƒ¡ãƒ¼ãƒ«èªè¨¼ / Verify Email",
    "already_have_account": "æ—¢ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ / Already have an account?",
    "create_account": "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ / Create Account"
  },
  
  "register": {
    "title": "æ–°è¦ç™»éŒ² / Sign Up",
    "password_length": "8æ–‡å­—ä»¥ä¸Š / At least 8 characters",
    "password_chars": "è‹±æ•°å­—ã‚’å«ã‚€ / Include letters and numbers",
    "email_sent": "èªè¨¼ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ / Verification email sent",
    "check_email": "ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ / Please check your email"
  },
  
  "login": {
    "title": "ãƒ­ã‚°ã‚¤ãƒ³ / Login", 
    "email_not_verified": "ãƒ¡ãƒ¼ãƒ«èªè¨¼ãŒå¿…è¦ã§ã™ / Email verification required",
    "invalid_credentials": "ãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ / Invalid email or password"
  },
  
  "verify": {
    "title": "ãƒ¡ãƒ¼ãƒ«èªè¨¼ / Email Verification",
    "message": "èªè¨¼ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«å†…ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚/ We sent you a verification email. Please click the link in the email.",
    "resend": "ãƒ¡ãƒ¼ãƒ«å†é€ä¿¡ / Resend Email", 
    "check_verification": "èªè¨¼ç¢ºèª / Check Verification"
  }
}
```

## ğŸš€ å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: Firebase åŸºç›¤
1. Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
2. Authentication æœ‰åŠ¹åŒ–
3. SDK çµ±åˆ

### Phase 2: èªè¨¼UI
1. ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ä½œæˆ
2. ãƒ¡ãƒ¼ãƒ«èªè¨¼ç”»é¢
3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½

### Phase 3: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆ
1. Firebase Admin SDK å®Ÿè£…
2. èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ä½œæˆ
3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ‹¡å¼µ

### Phase 4: æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
1. æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã®ç§»è¡Œ
2. èªè¨¼çŠ¶æ…‹ã§ã®æ©Ÿèƒ½åˆ¶é™
3. å¤šè¨€èªå¯¾å¿œ

## ğŸ’¡ æœŸå¾…ã™ã‚‹æˆæœ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“
- å®‰å…¨ã§ç°¡å˜ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¿˜ã‚Œã¦ã‚‚å®‰å¿ƒ
- ãƒ¡ãƒ¼ãƒ«èªè¨¼ã«ã‚ˆã‚‹ä¿¡é ¼æ€§
- ãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨ãªå€‹äººç®¡ç†

### æŠ€è¡“çš„æˆæœ
- ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¬ãƒ™ãƒ«ã®èªè¨¼
- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ‡ãƒ¼ã‚¿ä¿è­·
- å›½éš›æ¨™æº–ã®å®Ÿè£…

## ğŸ“ å®Ÿè£…æŒ‡ç¤º

**ã“ã®è¦ä»¶ã«åŸºã¥ãã€Firebase Authentication ã‚’ä½¿ç”¨ã—ãŸå®Œå…¨ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚**

**å§”ä»»äº‹é …ï¼š**
- Firebase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°è¨­å®š
- èªè¨¼UIã®å…·ä½“çš„ãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã®æœ€é©åŒ–
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã¨ã®çµ±åˆæ–¹æ³•

**æœŸå¾…ã™ã‚‹æˆæœç‰©ï¼š**
- å®Œå…¨ã«å‹•ä½œã™ã‚‹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 
- ç¾ã—ãç›´æ„Ÿçš„ãªèªè¨¼UI
- ã‚»ã‚­ãƒ¥ã‚¢ã§ä¿¡é ¼æ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ 
- æ—¢å­˜æ©Ÿèƒ½ã¨ã®å®Œç’§ãªçµ±åˆ

**ã“ã‚Œã§TENAX/PERSISTOãŒä¸–ç•Œãƒ¬ãƒ™ãƒ«ã®ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«ã‚¢ãƒ—ãƒªã¨ã—ã¦å®Œæˆã—ã¾ã™ï¼**