{% extends "base.html" %}

{% block title %}ダッシュボード - BodyScale{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1>BodyScale ダッシュボード</h1>
        <p class="subtitle">AI搭載フィットネストレーニングシステム</p>
    </div>

    <!-- ウェルカムメッセージ -->
    <div class="welcome-section mb-4">
        <h2>ようこそ、{{ session.get('user_email', 'ゲスト') }}さん</h2>
        <p>今日も健康的な一日を過ごしましょう！</p>
    </div>

    <!-- クイックアクセス -->
    <div class="feature-grid">
        <!-- トレーニング分析 -->
        <div class="feature-card" onclick="window.location.href='/'">
            <div class="feature-icon">🏋️</div>
            <h3>フォーム分析</h3>
            <p>動画からBIG3の運動フォームをAI分析</p>
            <div class="feature-stats">
                <span class="stat-label">今週の分析回数:</span>
                <span class="stat-value">12回</span>
            </div>
        </div>

        <!-- ワークアウト記録 -->
        <div class="feature-card" onclick="window.location.href='/workout_record'">
            <div class="feature-icon">📝</div>
            <h3>ワークアウト記録</h3>
            <p>トレーニング内容を記録・管理</p>
            <div class="feature-stats">
                <span class="stat-label">今月の記録:</span>
                <span class="stat-value">24回</span>
            </div>
        </div>

        <!-- エクササイズDB -->
        <div class="feature-card" onclick="window.location.href='/exercise_database'">
            <div class="feature-icon">📚</div>
            <h3>エクササイズDB</h3>
            <p>300種類以上のエクササイズを検索</p>
            <div class="feature-stats">
                <span class="stat-label">登録種目:</span>
                <span class="stat-value">312種</span>
            </div>
        </div>

        <!-- 食事分析 -->
        <div class="feature-card" onclick="window.location.href='/meal_analysis'">
            <div class="feature-icon">🍽️</div>
            <h3>食事分析</h3>
            <p>写真から栄養情報を自動分析</p>
            <div class="feature-stats">
                <span class="stat-label">今週の分析:</span>
                <span class="stat-value">8食</span>
            </div>
        </div>

        <!-- 栄養トラッキング -->
        <div class="feature-card" onclick="window.location.href='/nutrition_tracking'">
            <div class="feature-icon">📊</div>
            <h3>栄養管理</h3>
            <p>日々の栄養摂取を記録・分析</p>
            <div class="feature-stats">
                <span class="stat-label">平均カロリー:</span>
                <span class="stat-value">2,150 kcal</span>
            </div>
        </div>

        <!-- 進捗統計 -->
        <div class="feature-card" onclick="window.location.href='/progress'">
            <div class="feature-icon">📈</div>
            <h3>進捗統計</h3>
            <p>トレーニング成果を可視化</p>
            <div class="feature-stats">
                <span class="stat-label">今月の成長:</span>
                <span class="stat-value">+12%</span>
            </div>
        </div>
    </div>

    <!-- 高度な機能 -->
    <div class="advanced-features mt-5">
        <h2>高度な機能</h2>
        <div class="advanced-grid">
            <!-- データ管理 -->
            <div class="advanced-card">
                <h4>データ管理</h4>
                <ul>
                    <li><a href="/data_consent">データ利用同意</a></li>
                    <li><a href="/training_data">トレーニングデータ管理</a></li>
                    <li><a href="/data_preprocessing">データ前処理</a></li>
                </ul>
            </div>

            <!-- 機械学習 -->
            <div class="advanced-card">
                <h4>AI/ML機能</h4>
                <ul>
                    <li><a href="/simple_training">簡易トレーニング分析</a></li>
                    <li><a href="#" onclick="alert('ML APIドキュメントは準備中です')">ML API</a></li>
                    <li><a href="#" onclick="alert('モデル管理は準備中です')">モデル管理</a></li>
                </ul>
            </div>

            <!-- 設定・その他 -->
            <div class="advanced-card">
                <h4>設定・その他</h4>
                <ul>
                    <li><a href="/settings">アカウント設定</a></li>
                    <li><a href="#" onclick="alert('ヘルプドキュメントは準備中です')">ヘルプ</a></li>
                    <li><a href="/logout">ログアウト</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- システム情報 -->
    <div class="system-info mt-5">
        <h3>システム情報</h3>
        <div class="info-grid">
            <div class="info-item">
                <span class="info-label">バージョン:</span>
                <span class="info-value">1.2.0</span>
            </div>
            <div class="info-item">
                <span class="info-label">ML モデル:</span>
                <span class="info-value">v3.1 (2024.12)</span>
            </div>
            <div class="info-item">
                <span class="info-label">データベース:</span>
                <span class="info-value">312 エクササイズ</span>
            </div>
            <div class="info-item">
                <span class="info-label">API ステータス:</span>
                <span class="info-value status-ok">正常</span>
            </div>
        </div>
    </div>
</div>

<style>
.welcome-section {
    background: linear-gradient(135deg, var(--primary-color, #007bff) 0%, #0056b3 100%);
    color: white;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
}

.welcome-section h2 {
    margin: 0 0 10px 0;
}

.feature-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 30px;
}

.feature-card {
    background: white;
    border-radius: 15px;
    padding: 30px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
}

.feature-icon {
    font-size: 3rem;
    margin-bottom: 15px;
}

.feature-card h3 {
    font-size: 1.3rem;
    margin-bottom: 10px;
    color: var(--primary-color, #007bff);
}

.feature-card p {
    color: var(--text-muted, #6c757d);
    margin-bottom: 15px;
}

.feature-stats {
    background: var(--hover-bg, #f8f9fa);
    padding: 10px;
    border-radius: 8px;
    font-size: 0.9rem;
}

.stat-label {
    color: var(--text-muted, #6c757d);
}

.stat-value {
    font-weight: bold;
    color: var(--primary-color, #007bff);
}

.advanced-features {
    margin-top: 50px;
}

.advanced-features h2 {
    margin-bottom: 20px;
}

.advanced-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.advanced-card {
    background: var(--hover-bg, #f8f9fa);
    padding: 20px;
    border-radius: 10px;
}

.advanced-card h4 {
    margin-bottom: 15px;
    color: var(--primary-color, #007bff);
}

.advanced-card ul {
    list-style: none;
    padding: 0;
}

.advanced-card li {
    margin-bottom: 10px;
}

.advanced-card a {
    color: var(--text-color, #333);
    text-decoration: none;
}

.advanced-card a:hover {
    color: var(--primary-color, #007bff);
    text-decoration: underline;
}

.system-info {
    background: var(--hover-bg, #f8f9fa);
    padding: 20px;
    border-radius: 10px;
}

.system-info h3 {
    margin-bottom: 15px;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.info-item {
    display: flex;
    justify-content: space-between;
}

.info-label {
    color: var(--text-muted, #6c757d);
}

.info-value {
    font-weight: bold;
}

.status-ok {
    color: #28a745;
}

.mb-4 {
    margin-bottom: 1.5rem;
}

.mt-5 {
    margin-top: 3rem;
}

@media (max-width: 768px) {
    .feature-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
// ダッシュボードの初期化
document.addEventListener('DOMContentLoaded', function() {
    // 統計データの更新
    updateDashboardStats();
});

async function updateDashboardStats() {
    try {
        // ここで実際のAPIからデータを取得
        // const response = await fetch('/api/dashboard/stats');
        // const data = await response.json();
        // 統計を更新
    } catch (error) {
        console.error('統計データの取得エラー:', error);
    }
}
</script>
{% endblock %}